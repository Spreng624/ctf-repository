from Crypto.Cipher import AES
from hashlib import sha256
from Crypto.Util.number import *
from Crypto.Util.Padding import pad

message = b'xxxxxx'
flag = 'flag{' + sha256(message).hexdigest()[32:][::-1] + '}'

n = getPrime(1024) * getPrime(1024)
part1 = getPrime(50)
m1 = b'zzz'
m2 = b':\x98\xf6\xe0\x82$'
m3 = b'\x1c\x08\xeey\x8a\xaa+-('
c1 = pow(bytes_to_long(m1),part1,n)
c2 = pow(bytes_to_long(m2),part1,n)
c3 = pow(bytes_to_long(m3),part1,n)
print("c1 = ",c1)
print("c2 = ",c2)
print("c3 = ",c3)
print('-------')

part2 = getPrime(80)
mod = getPrime(16)

R.<x> = PolynomialRing(GF(mod))
N = 25084*x^255 + 32363*x^254 + 21665*x^253 + 24571*x^252 + 20587*x^251 + 17472*x^250 + 30654*x^249 + 31322*x^248 + 23385*x^247 + 14049*x^246 + 27853*x^245 + 18183*x^244 + 33130*x^243 + 29218*x^242 + 3412*x^241 + 28875*x^240 + 1551*x^239 + 15231*x^238 + 32794*x^237 + 8541*x^236 + 23025*x^235 + 21145*x^234 + 11858*x^233 + 34388*x^232 + 21092*x^231 + 22355*x^230 + 1768*x^229 + 5868*x^228 + 1502*x^227 + 30644*x^226 + 24646*x^225 + 32356*x^224 + 27350*x^223 + 34810*x^222 + 27676*x^221 + 24351*x^220 + 9218*x^219 + 27073*x^218 + 21176*x^217 + 2139*x^216 + 8244*x^215 + 1887*x^214 + 3854*x^213 + 24362*x^212 + 10981*x^211 + 14237*x^210 + 28663*x^209 + 32272*x^208 + 29911*x^207 + 13575*x^206 + 15955*x^205 + 5367*x^204 + 34844*x^203 + 15036*x^202 + 7662*x^201 + 16816*x^200 + 1051*x^199 + 16540*x^198 + 17738*x^197 + 10212*x^196 + 4180*x^195 + 33126*x^194 + 13014*x^193 + 16584*x^192 + 10139*x^191 + 27520*x^190 + 116*x^189 + 28197*x^188 + 31755*x^187 + 10917*x^186 + 28271*x^185 + 1152*x^184 + 6118*x^183 + 27171*x^182 + 14265*x^181 + 905*x^180 + 13776*x^179 + 854*x^178 + 5397*x^177 + 14898*x^176 + 1388*x^175 + 14058*x^174 + 6871*x^173 + 13508*x^172 + 3102*x^171 + 20438*x^170 + 29122*x^169 + 17072*x^168 + 23021*x^167 + 29879*x^166 + 28424*x^165 + 8616*x^164 + 21771*x^163 + 31878*x^162 + 33793*x^161 + 9238*x^160 + 23751*x^159 + 24157*x^158 + 17665*x^157 + 34015*x^156 + 9925*x^155 + 2981*x^154 + 24715*x^153 + 13223*x^152 + 1492*x^151 + 7548*x^150 + 13335*x^149 + 24773*x^148 + 15147*x^147 + 25234*x^146 + 24394*x^145 + 27742*x^144 + 29033*x^143 + 10247*x^142 + 22010*x^141 + 18634*x^140 + 27877*x^139 + 27754*x^138 + 13972*x^137 + 31376*x^136 + 17211*x^135 + 21233*x^134 + 5378*x^133 + 27022*x^132 + 5107*x^131 + 15833*x^130 + 27650*x^129 + 26776*x^128 + 7420*x^127 + 20235*x^126 + 2767*x^125 + 2708*x^124 + 31540*x^123 + 16736*x^122 + 30955*x^121 + 14959*x^120 + 13171*x^119 + 5450*x^118 + 20204*x^117 + 18833*x^116 + 33989*x^115 + 25970*x^114 + 767*x^113 + 16400*x^112 + 34931*x^111 + 7923*x^110 + 33965*x^109 + 12199*x^108 + 11788*x^107 + 19343*x^106 + 33039*x^105 + 13475*x^104 + 15822*x^103 + 20921*x^102 + 25100*x^101 + 9771*x^100 + 5272*x^99 + 34002*x^98 + 16026*x^97 + 23104*x^96 + 33331*x^95 + 11944*x^94 + 5428*x^93 + 11838*x^92 + 30854*x^91 + 18595*x^90 + 5226*x^89 + 23614*x^88 + 5611*x^87 + 34572*x^86 + 17035*x^85 + 16199*x^84 + 26755*x^83 + 10270*x^82 + 25206*x^81 + 30800*x^80 + 21714*x^79 + 2088*x^78 + 3785*x^77 + 9626*x^76 + 25706*x^75 + 24807*x^74 + 31605*x^73 + 5292*x^72 + 17836*x^71 + 32529*x^70 + 33088*x^69 + 16369*x^68 + 18195*x^67 + 22227*x^66 + 8839*x^65 + 27975*x^64 + 10464*x^63 + 29788*x^62 + 15770*x^61 + 31095*x^60 + 276*x^59 + 25968*x^58 + 14891*x^57 + 23490*x^56 + 34563*x^55 + 29778*x^54 + 26719*x^53 + 28611*x^52 + 1633*x^51 + 28335*x^50 + 18278*x^49 + 33901*x^48 + 13451*x^47 + 30759*x^46 + 19192*x^45 + 31002*x^44 + 11733*x^43 + 29274*x^42 + 11756*x^41 + 6880*x^40 + 11492*x^39 + 7151*x^38 + 28624*x^37 + 29566*x^36 + 33986*x^35 + 5726*x^34 + 5040*x^33 + 14730*x^32 + 7443*x^31 + 12168*x^30 + 24201*x^29 + 20390*x^28 + 15087*x^27 + 18193*x^26 + 19796*x^25 + 32514*x^24 + 25252*x^23 + 15090*x^22 + 2653*x^21 + 29310*x^20 + 4037*x^19 + 6440*x^18 + 16780*x^17 + 1891*x^16 + 20592*x^15 + 11890*x^14 + 25769*x^13 + 29259*x^12 + 23814*x^11 + 17565*x^10 + 16797*x^9 + 34151*x^8 + 20893*x^7 + 2807*x^6 + 209*x^5 + 3217*x^4 + 8801*x^3 + 21964*x^2 + 16286*x + 1207

S.<x> = R.quotient(N)
g = x
c = g ^ part2
print("mod = ",mod)
print("c = ",c)
print('-------')

A =  [
     [1287397632974625907369332145667695136576732725719,  999149001044306271168727399637009399486427921379,   1046504160269652701583906344218556291030141088947,  724446625683754938181565321149725788430461092168,    1071845980147173642753960259602135592110139561915],
     [947603660931904341080240982051313712707367037453,   312289846563741934103580532543082761760226637905,   494739786803547247505263837170488583876166831850,   680540462980071181450018491798299105995449257198,    2602258415762368797405060707505977243346704576],
     [996213673531855992829525358578006610606634622631,   1025711294257038288640877971869685565227647136954,  1432432135773706484846126533752827108541355741973,  1238541870126055576875033883691918425137600727481,   1130938956963588695293783764965618873887596017827],
     [1320933266015680090206505704792362493057963931979,  1151746112645644166669332171392580649376526147475,  117512451110908867093773368598681106589771485221,   78071463743800894350883457304401524272336187149,     350437511649326676405126284689545814008237687775],
     [438339253001275654203062260777687750937184662400,   372483950165136927369598298270629892810999203086,   859008773869616460027135965589262417694174453098,   1174526536643808668299968641952541506024584582818,   13201859260259503932772826643483081858286638179]
    ]

p = 1461501637330902918203684832716283019655932542983
A=Matrix(GF(p),A)
part3=randint(1,p-1)
enc=A ^ part3
print(enc)
print('-------')

All = part1 + part2 + part3
key = md5(str(All).encode()).hexdigest()[:16]
cipher = AES.new(key.encode(),AES.MODE_ECB)
CiperText = cipher.encrypt(pad(message,16))
print("CiperText =",CiperText)
print('What you need to submit is flag!')



'''
c1 = 1790064029876341976237307392954303240683485154655604205702671802338084953503431714871972122706034874742568072261191119160763863137961475625002894844004891260697595019907465755278638262147762379394415601861969179328855097462092631535981296001537399551639314331857176486214166299414062589768890263443278044795056175271819593655383503567679594909946112809736720406543448907122361577115534036883997133013430910162633465469329414746934054773560341062981310424264474787644557966610302754961777570611276912565113137718226850416211606074094264178783078305184709084902846670288088184932348269365506181921773002330580679734918
c2 = 17225757435575450389818088399433095156697021573983807106939124691102393835731406576540737759268850620280271361657087639901664008137854522875110325269252629052534860844747481251299546880445923665167570042341188891834337386413163198062248198462483926604076945786774091543309003786342127373409686595299934993139942352031396769039365555320211251090663701937628135476848609501115621384642389611313117199736967190795765167440771370922150598580998931016742537348664293083640407386888452849713466310048608615223994959668995233158600361723621126320585856609763844794654347576059465336943945067547715844981502578084903841428173
c3 = 6127501106046614276456935443305216078919479284921436149700502985365827297723002319904262457562294621244877794577751091983493467924877003070506852982421104959014095295275838345680174716500487745058844786649396734458375692717731311227458816076330431556974809846475830035624319565838255507062053820557011587735952469535859804356636312852847577634117557915374639542142876241686212680612046651342956091409853542776232386505921847772358725001821126108481098669654725854622292299844253696513046953513069393536282920810525837541811955323956831934298727480562864749898968182001537192475368582272947583927642428256534191002062
-------
mod = 60901
c = 30973*x^254 + 30844*x^253 + 7870*x^252 + 4082*x^251 + 18592*x^250 + 34047*x^249 + 53996*x^248 + 58679*x^247 + 57655*x^246 + 13454*x^245 + 30443*x^244 + 48856*x^243 + 23838*x^242 + 30886*x^241 + 48589*x^240 + 50619*x^239 + 42639*x^238 + 54735*x^237 + 54955*x^236 + 52741*x^235 + 41220*x^234 + 36173*x^233 + 9481*x^232 + 26002*x^231 + 28583*x^230 + 43331*x^229 + 14233*x^228 + 13795*x^227 + 11776*x^226 + 45901*x^225 + 23086*x^224 + 70*x^223 + 57985*x^222 + 52714*x^221 + 43922*x^220 + 49897*x^219 + 60845*x^218 + 22310*x^217 + 42708*x^216 + 57808*x^215 + 10614*x^214 + 30350*x^213 + 292*x^212 + 55663*x^211 + 50583*x^210 + 59438*x^209 + 57063*x^208 + 42842*x^207 + 20579*x^206 + 35796*x^205 + 42287*x^204 + 51707*x^203 + 25546*x^202 + 42414*x^201 + 48261*x^200 + 24008*x^199 + 55811*x^198 + 8913*x^197 + 58858*x^196 + 23767*x^195 + 59525*x^194 + 27750*x^193 + 4283*x^192 + 2737*x^191 + 39854*x^190 + 55954*x^189 + 50942*x^188 + 29950*x^187 + 38369*x^186 + 35469*x^185 + 32119*x^184 + 49311*x^183 + 12714*x^182 + 56593*x^181 + 57898*x^180 + 10885*x^179 + 11148*x^178 + 31621*x^177 + 45545*x^176 + 26021*x^175 + 35169*x^174 + 52724*x^173 + 60068*x^172 + 46585*x^171 + 56041*x^170 + 39233*x^169 + 49111*x^168 + 34393*x^167 + 31721*x^166 + 22836*x^165 + 31842*x^164 + 32651*x^163 + 56840*x^162 + 29985*x^161 + 39397*x^160 + 32411*x^159 + 12326*x^158 + 35303*x^157 + 36163*x^156 + 53507*x^155 + 37721*x^154 + 11967*x^153 + 17944*x^152 + 11907*x^151 + 22737*x^150 + 18174*x^149 + 29759*x^148 + 39971*x^147 + 43901*x^146 + 43588*x^145 + 23780*x^144 + 46281*x^143 + 39243*x^142 + 60028*x^141 + 11114*x^140 + 12727*x^139 + 45561*x^138 + 56668*x^137 + 55869*x^136 + 18422*x^135 + 34872*x^134 + 14945*x^133 + 17324*x^132 + 33915*x^131 + 41226*x^130 + 3845*x^129 + 38559*x^128 + 4456*x^127 + 7698*x^126 + 13557*x^125 + 50698*x^124 + 43608*x^123 + 34467*x^122 + 49204*x^121 + 43371*x^120 + 9099*x^119 + 41268*x^118 + 48971*x^117 + 6915*x^116 + 5040*x^115 + 32017*x^114 + 24391*x^113 + 52984*x^112 + 47532*x^111 + 56022*x^110 + 28678*x^109 + 5349*x^108 + 24013*x^107 + 59749*x^106 + 9908*x^105 + 14074*x^104 + 4281*x^103 + 47732*x^102 + 52807*x^101 + 11229*x^100 + 51198*x^99 + 18953*x^98 + 39935*x^97 + 20141*x^96 + 16426*x^95 + 1731*x^94 + 27518*x^93 + 46175*x^92 + 52067*x^91 + 3097*x^90 + 48882*x^89 + 36760*x^88 + 11227*x^87 + 31334*x^86 + 26083*x^85 + 2212*x^84 + 33391*x^83 + 13452*x^82 + 22866*x^81 + 59087*x^80 + 29840*x^79 + 45797*x^78 + 55257*x^77 + 6147*x^76 + 42650*x^75 + 45858*x^74 + 35593*x^73 + 12980*x^72 + 7094*x^71 + 26326*x^70 + 36941*x^69 + 38665*x^68 + 24926*x^67 + 49624*x^66 + 57611*x^65 + 19907*x^64 + 25569*x^63 + 26082*x^62 + 25232*x^61 + 49743*x^60 + 5299*x^59 + 20453*x^58 + 14107*x^57 + 26463*x^56 + 27491*x^55 + 41071*x^54 + 49263*x^53 + 56277*x^52 + 38917*x^51 + 24792*x^50 + 51915*x^49 + 41877*x^48 + 47022*x^47 + 46105*x^46 + 56256*x^45 + 51426*x^44 + 46176*x^43 + 54895*x^42 + 36054*x^41 + 1196*x^40 + 47104*x^39 + 3037*x^38 + 19154*x^37 + 49011*x^36 + 34506*x^35 + 42205*x^34 + 4275*x^33 + 49958*x^32 + 40629*x^31 + 32093*x^30 + 51447*x^29 + 26866*x^28 + 26439*x^27 + 40618*x^26 + 29193*x^25 + 37794*x^24 + 21065*x^23 + 20790*x^22 + 42873*x^21 + 44153*x^20 + 15265*x^19 + 31199*x^18 + 34847*x^17 + 22036*x^16 + 21321*x^15 + 28901*x^14 + 606*x^13 + 8767*x^12 + 20990*x^11 + 37318*x^10 + 23961*x^9 + 42977*x^8 + 41805*x^7 + 17314*x^6 + 44256*x^5 + 8873*x^4 + 36862*x^3 + 18983*x^2 + 3678*x + 20257
-------
[1137231678649111986418426323705488757362052256248 1275754870226546368142822180985385195928528472654  557214834104097871640664204909994937052450001975  145023493602872260881347708055585443650046405883 1283775394766152537214910003858987990641686322701]
[  24415365646755646195923685875204038532042541292 1086865496975097236094977923939666531485988223762  264094572819537749834323988580892885749606164559  124894655851287206231281210808920274920094831556  805696500662130854264198837242747230244197497780]
[ 636006128467308856088758448583963669099165463947 1237371300833477443312465203816697781387842264162  604255884531384974902659027005713172746665109930  817218249105281370168272878970454269414272716916 1171583331700722572405309782163554543142354039203]
[ 781666471957305023083056789896602008387817162830 1017674048051642313127046068977583159908007389751  719490009837934718274681654903158194668681130231 1198403822627688285330051549565405965877125490562  952841098005275617732494903412498336078112455711]
[ 989519235306974935468589452384626792088752492129  791819020512220835032324102003950629519764822776  698519597848113226815005327846800302301395708484 1265902948669118247882299269136507266567345180542  889147071870110758089365859462562765264413376867]
-------
CiperText = b"~\x8f\x8b>u\x94\x89F\x93\xf1x\x97\x8cp\x02\xfc\x99C\xc6\x0e\xf1L\xff#GM'^1\xca\xa3\x1a"
What you need to submit is flag!
'''