from Crypto.Util.number import *
import random
from sympy import prime

FLAG = b"hgame{xxxxxxxxxxxxxxxxxx}"
e = 0x10001


def primorial(num):
    result = 1
    for i in range(1, num + 1):
        result *= prime(i)
    return result


M = primorial(random.choice([39, 71, 126]))
M = primorial(39)


def gen_key():
    while True:
        k = getPrime(random.randint(20, 40))
        k = getPrime(20)
        a = getPrime(random.randint(20, 60))
        p = k * M + pow(e, a, M)
        if isPrime(p):
            return p


p, q = gen_key(), gen_key()
n = p * q
m = bytes_to_long(FLAG)
enc = pow(m, e, n)

print(f"{n=}")
print(f"{enc=}")

"""
n=787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241
enc=365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408
"""

n = 434950628847783700096288903405997668452297719673924072966652698468718938631672073074692900616845865080463167827070587333517262928430176489620591
enc = 192324521090600993198226108669370436539265119156411591773044030189605724914216991917610322741819853068903613625920884312715858682284487631347234
