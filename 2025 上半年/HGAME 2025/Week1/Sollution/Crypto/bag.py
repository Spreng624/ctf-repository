from Crypto.Util.number import *
from Crypto.Cipher import AES
import hashlib
import itertools


def decrypt(p):
    ciphertext = b'\x1d6\xcc}\x07\xfa7G\xbd\x01\xf0P4^Q"\x85\x9f\xac\x98\x8f#\xb2\x12\xf4+\x05`\x80\x1a\xfa !\x9b\xa5\xc7g\xa8b\x89\x93\x1e\xedz\xd2M;\xa2'
    key = hashlib.sha256(str(p).encode()).digest()
    cipher = AES.new(key, AES.MODE_ECB)
    plaintext = cipher.decrypt(ciphertext)
    print(f"plaintext={plaintext}")


def check(M, S, p):
    return sum(x * y for x, y in zip(M, p)) == S


def binToInt(bin_list):
    try:
        return int("".join(map(str, bin_list)), 2)
    except:
        return 0


list = [
    [
        2826962231,
        3385780583,
        3492076631,
        3387360133,
        2955228863,
        2289302839,
        2243420737,
        4129435549,
        4249730059,
        3553886213,
        3506411549,
        3658342997,
        3701237861,
        4279828309,
        2791229339,
        4234587439,
        3870221273,
        2989000187,
        2638446521,
        3589355327,
        3480013811,
        3581260537,
        2347978027,
        3160283047,
        2416622491,
        2349924443,
        3505689469,
        2641360481,
        3832581799,
        2977968451,
        4014818999,
        3989322037,
        4129732829,
        2339590901,
        2342044303,
        3001936603,
        2280479471,
        3957883273,
        3883572877,
        3337404269,
        2665725899,
        3705443933,
        2588458577,
        4003429009,
        2251498177,
        2781146657,
        2654566039,
        2426941147,
        2266273523,
        3210546259,
        4225393481,
        2304357101,
        2707182253,
        2552285221,
        2337482071,
        3096745679,
        2391352387,
        2437693507,
        3004289807,
        3857153537,
        3278380013,
        3953239151,
        3486836107,
        4053147071,
    ],
    [
        2241199309,
        3658417261,
        3032816659,
        3069112363,
        4279647403,
        3244237531,
        2683855087,
        2980525657,
        3519354793,
        3290544091,
        2939387147,
        3669562427,
        2985644621,
        2961261073,
        2403815549,
        3737348917,
        2672190887,
        2363609431,
        3342906361,
        3298900981,
        3874372373,
        4287595129,
        2154181787,
        3475235893,
        2223142793,
        2871366073,
        3443274743,
        3162062369,
        2260958543,
        3814269959,
        2429223151,
        3363270901,
        2623150861,
        2424081661,
        2533866931,
        4087230569,
        2937330469,
        3846105271,
        3805499729,
        4188683131,
        2804029297,
        2707569353,
        4099160981,
        3491097719,
        3917272979,
        2888646377,
        3277908071,
        2892072971,
        2817846821,
        2453222423,
        3023690689,
        3533440091,
        3737441353,
        3941979749,
        2903000761,
        3845768239,
        2986446259,
        3630291517,
        3494430073,
        2199813137,
        2199875113,
        3794307871,
        2249222681,
        2797072793,
    ],
    [
        4263404657,
        3176466407,
        3364259291,
        4201329877,
        3092993861,
        2771210963,
        3662055773,
        3124386037,
        2719229677,
        3049601453,
        2441740487,
        3404893109,
        3327463897,
        3742132553,
        2833749769,
        2661740833,
        3676735241,
        2612560213,
        3863890813,
        3792138377,
        3317100499,
        2967600989,
        2256580343,
        2471417173,
        2855972923,
        2335151887,
        3942865523,
        2521523309,
        3183574087,
        2956241693,
        2969535607,
        2867142053,
        2792698229,
        3058509043,
        3359416111,
        3375802039,
        2859136043,
        3453019013,
        3817650721,
        2357302273,
        3522135839,
        2997389687,
        3344465713,
        2223415097,
        2327459153,
        3383532121,
        3960285331,
        3287780827,
        4227379109,
        3679756219,
        2501304959,
        4184540251,
        3918238627,
        3253307467,
        3543627671,
        3975361669,
        3910013423,
        3283337633,
        2796578957,
        2724872291,
        2876476727,
        4095420767,
        3011805113,
        2620098961,
    ],
    [
        2844773681,
        3852689429,
        4187117513,
        3608448149,
        2782221329,
        4100198897,
        3705084667,
        2753126641,
        3477472717,
        3202664393,
        3422548799,
        3078632299,
        3685474021,
        3707208223,
        2626532549,
        3444664807,
        4207188437,
        3422586733,
        2573008943,
        2992551343,
        3465105079,
        4260210347,
        3108329821,
        3488033819,
        4092543859,
        4184505881,
        3742701763,
        3957436129,
        4275123371,
        3307261673,
        2871806527,
        3307283633,
        2813167853,
        2319911773,
        3454612333,
        4199830417,
        3309047869,
        2506520867,
        3260706133,
        2969837513,
        4056392609,
        3819612583,
        3520501211,
        2949984967,
        4234928149,
        2690359687,
        3052841873,
        4196264491,
        3493099081,
        3774594497,
        4283835373,
        2753384371,
        2215041107,
        4054564757,
        4074850229,
        2936529709,
        2399732833,
        3078232933,
        2922467927,
        3832061581,
        3871240591,
        3526620683,
        2304071411,
        3679560821,
    ],
]

bag = [123342809734, 118191282440, 119799979406, 128273451872]

p = []
# for i in range(len(list)):
#     # print([(x, 1) for x in list[i]])
#     print(sum(x * y for x, y in zip(list[i], p)))
#     bag[i] = sum(list[i]) - bag[i]
#     list[i] = list[i][1:]
# # print(f"list={list}")
# print(f"bag={bag}")


p = (
    1,
    0,
    0,
    1,
    1,
    1,
    1,
    1,
    1,
    1,
    0,
    1,
    1,
    0,
    1,
    1,
    0,
    0,
    1,
    0,
    1,
    1,
    0,
    0,
    0,
    1,
    0,
    0,
    0,
    0,
    0,
    1,
    1,
    0,
    1,
    0,
    1,
    0,
    0,
    0,
    0,
    1,
    1,
    0,
    1,
    0,
    0,
    1,
    1,
    0,
    0,
    0,
    0,
    0,
    1,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
)
p = [1 - x for x in p]
print(len(p))
j = 3
M = list[j].copy()
S = bag[j]
N = 3
print(f"M={[x%N for x in M]}\nS={S%N}")
# print(check(M, S, p))
# decrypt(binToInt(p))
