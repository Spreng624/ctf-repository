from Crypto.Util.number import getPrime, bytes_to_long
from random import randint
import os

FLAG = os.getenv("FLAG").encode()
flag1 = FLAG[:15]
flag2 = FLAG[15:]


def crypto1():
    p = getPrime(1024)
    q = getPrime(1024)
    n = p * q
    e = 0x10001
    x1 = randint(0, 2**11)
    y1 = randint(0, 2**114)
    x2 = randint(0, 2**11)
    y2 = randint(0, 2**514)
    hint1 = x1 * p + y1 * q - 0x114
    hint2 = x2 * p + y2 * q - 0x514
    c = pow(bytes_to_long(flag1), e, n)
    print(n)
    print(c)
    print(hint1)
    print(hint2)


def crypto2():
    p = getPrime(1024)
    q = getPrime(1024)
    n = p * q
    e = 0x10001
    hint = pow(514 * p - 114 * q, n - p - q, n)
    c = pow(bytes_to_long(flag2), e, n)
    print(n)
    print(c)
    print(hint)


# b'flag{6bcceae6-beb0-'
# b'4dd6-b764-bd0fdcaeeb5f}'
# b'flag{6bcceae6-beb0-4dd6-b764-bd0fdcaeeb5f}'

print("==================================================================")
crypto1()
print("==================================================================")
crypto2()
print("==================================================================")

"""
==================================================================
16642706322620992688417701910792317005363501332847680388355418609545760841268023787785256355265784673382949773415746306276290697801708831635252199828289052818255227308172987595738470187235565701471708271686661929426362002517463407365695792869114604783009262118527529674421519869939541252882931128127358574977536904295389916369614722137312636244183867323068503703483936137971253048249770629096450674436008960117437394667517932462090707863228631584355874362633251137095788531885420499461530985938428457757831565386128225606489141393988180659844567063717151734872920344641443570247658854592263093534543018745913227906307
11339153652195091663466375315539527205335918523617712821297428217281528653626438387302907795894403050564536903102297732407451446267387448055943156328209324863557608922808593629890673049022920663810216459391939631940340416518313523563040753267726892587980770955668652498686517772968104379172177575787816906704996292253726920268355198023359770388878273108070420745989509414120439863174088709363276107534791774474407821319999443516183936951869742335871936884280440472602662147556694822371100551944801772217680871019100356735852627393912741270737176186118681329130917302675425678544665145137214102570643446666170118819852
1190093470280678120821562772918028208105359540360614092416244412997509411187609208049656182601101323369976024791902945372039753251329906938038286485869049963558821583424059167373397277434804115901193052160781077394478635040313941401042189734262878126040073812124350294123122576021720467248560965590474937215411397408221718352316491244607206666
1602456958307463315820936550687432224718335253034242661682529797735774087106327544719535626285785650872248000400643195605026257830639747527792869996161298626292163601805966836259495472293852977827199265056734200086560156357667800984391659400138898369114523758082139923183361606156387123263066875215140910757209658287906640637586668168402686238457668260120751599406893391150992524788395719032521640676926710186016365094399566775467485068418683594432086912727284666
==================================================================
9534257033399052950961669783198465670092806347657461074983789709840477594898177820494535768394528986695879999203610567202750915674064737225752493027981783485933927515498396927647702757271381048062886043553128627417771642524989582356446338542666922249726710336117544984691841378191597345027595054621251295094924251766051040873622001142679548397566626978474314285678148275910058251887828637782725936666964535776405770345483322707998774558484463363931253183204070668693358357740904030829241981642643314580380950643220422682901245858276572264325878223957207536657272079894677831757204771334063980171204989463972042646649
1978675983073732255608328440699727860765811596619669772175151454440680842239059411898342453038725673906417145251901112130943568119479242985772461263874656571870763094182672770062156208505371907408746597390392467897935180585491330742685671236436473341000398513010935523959469981002310231321828277177663295975002584533207857428202451339996512934051833683489925424203697241949443552028419023615855222724680790285463287155850685072723202178089310216518381702340780265515799320952606125431714515409730531043503771324979280134109726007465101216900607615160483494662489179533697048170888684871249884363190445469157707428541
8778717332996111872446338677081411792492069728587701508311560555732644305216117723295671207721179306330373836458334497605806721904225635608581810182154269272786269722184788810471036392703434291693333979662249462054073185358347200001311684418173813534217699767518905568754367363454734150210317458300292400885141402162321361639875897832445766666442238542853316839095859458150401646961703148749399209252507246827712492546214477443405409336552291998264233173552757248483198961524522972340036640920468293313817584651773926096642742553834749228645295435844699194893148907427910027073626950207537264806907502320223785748987
==================================================================
"""
